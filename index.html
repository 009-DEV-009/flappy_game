<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird - Real Images</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #111;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            user-select: none;
        }

        /* Full-screen game container */
        #game-container {
            position: absolute;
            width: 100vw;
            height: 100vh;
            background-color: #70c5ce;
            background-image: url('background.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            overflow: hidden;
            border: 2px solid #fff;
            box-shadow: 0 0 40px rgba(0,0,0,0.6);
            animation: bg-pan 20s linear infinite alternate;
            will-change: transform, background-position;
        }

        @keyframes bg-pan {
            0%   { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        /* --- BIRD SETTINGS --- */
        #bird {
            position: absolute;
            width: 70px;
            height: 70px;
            background-image: url('didi.jpeg');
            background-size: cover;
            background-repeat: no-repeat;
            border-radius: 50%;
            top: 200px;
            left: 50px;
            z-index: 10;
            overflow: visible;
            box-shadow: 0 6px 16px rgba(0,0,0,0.5);
            will-change: transform, top;
        }

        /* ================= FUNNY CARTOON WINGS ================= */
        .wing {
            position: absolute;
            width: 42px;
            height: 24px;
            z-index: 9; /* behind the ball so face is visible */
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 40%, #f0932b 100%);
            border-radius: 60% 90% 60% 10%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            animation: wingFlap 0.32s ease-in-out infinite;
            will-change: transform;
        }

        .wing::before {
            content: "";
            position: absolute;
            width: 70%;
            height: 90%;
            right: -6px;
            top: 2px;
            background: radial-gradient(circle at 0% 50%, #ffeaa7 0%, #ffeaa7 30%, rgba(255,255,255,0) 60%);
            opacity: 0.9;
        }

        #wing-left {
            left: -25px;
            top: 20px;
            transform-origin: 100% 50%;
        }

        #wing-right {
            right: -30px;
            top: 20px;
            transform-origin: 0% 50%;
            transform: scaleX(-1);
        }

        @keyframes wingFlap {
            0%   { transform: translate3d(0,0,0) rotate(8deg); }
            50%  { transform: translate3d(0,-5px,0) rotate(-22deg); }
            100% { transform: translate3d(0,0,0) rotate(8deg); }
        }

        /* Faster animation when flying up */
        .fast-flap {
            animation-duration: 0.16s !important;
        }
        /* ======================================================= */

        /* --- PIPE SETTINGS --- */
        .pipe {
            position: absolute;
            width: 60px;
            background-image: url('modii.jpeg');
            background-size: 100% 100%;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 5;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.7));
            will-change: transform, left;
        }

        .pipe-top {
            transform: scaleY(-1);
        }
        
        .pipe-bottom {
            transform: none;
        }

        /* Score Board */
        #score {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 40px;
            color: #fff;
            font-weight: bold;
            z-index: 20;
            text-shadow: 2px 2px 0 #000;
            padding: 4px 16px;
            border-radius: 999px;
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(4px);
        }

        /* Menus */
        .menu-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top, rgba(0,0,0,0.7), rgba(0,0,0,0.95));
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 30;
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: #fff;
            text-shadow: 0 0 12px rgba(0,0,0,0.9);
            margin-bottom: 20px;
            font-size: 38px;
            text-align: center;
            letter-spacing: 2px;
            animation: titleFloat 3s ease-in-out infinite;
        }

        @keyframes titleFloat {
            0%   { transform: translateY(0); }
            50%  { transform: translateY(-6px); }
            100% { transform: translateY(0); }
        }

        .btn {
            padding: 12px 30px;
            margin: 5px;
            font-size: 18px;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 999px;
            border: 2px solid rgba(255,255,255,0.85);
            width: 180px;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 1px;
            box-shadow: 0 8px 18px rgba(0,0,0,0.6);
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            transition: transform 0.18s ease, box-shadow 0.18s ease, filter 0.18s ease;
        }

        .btn-easy    { background: linear-gradient(135deg, #27ae60, #2ecc71); }
        .btn-avg     { background: linear-gradient(135deg, #e67e22, #f39c12); }
        .btn-hard    { background: linear-gradient(135deg, #c0392b, #e74c3c); }
        .btn-restart { background: linear-gradient(135deg, #2980b9, #3498db); }

        .btn:hover {
            filter: brightness(1.07);
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 14px 28px rgba(0,0,0,0.75);
        }

        .btn:active {
            transform: translateY(0) scale(0.97);
            box-shadow: 0 5px 12px rgba(0,0,0,0.7);
        }
        
        #game-over-screen { display: none; }
        #difficulty-menu { display: none; }

        /* ================== MOBILE OPTIMIZATION ==================
           On smaller devices: cut heavy background animation and
           some shadows to reduce jank.
        ========================================================= */
        @media (max-width: 768px) {
            #game-container {
                animation: none;                 /* stop bg-pan on mobile */
                box-shadow: 0 0 18px rgba(0,0,0,0.6);
            }

            .pipe {
                filter: none;                   /* drop-shadow off on pipes */
            }

            #bird {
                box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            }

            h1 {
                animation: none;                /* stop title float on mobile */
            }

            .menu-screen {
                animation: none;                /* no fade-in animation */
            }

            .btn {
                transition: none;               /* simpler buttons */
                box-shadow: 0 6px 12px rgba(0,0,0,0.6);
            }
        }
    </style>
</head>
<body>

    <div id="game-container">
        <!-- BIRD + FUNNY WINGS -->
        <div id="bird">
            <div id="wing-left" class="wing"></div>
            <div id="wing-right" class="wing"></div>
        </div>

        <div id="score">0</div>

        <!-- FIRST SCREEN: PLAY -->
        <div id="main-menu" class="menu-screen">
            <h1>FLYING DIDI</h1>
            <button class="btn btn-main" onclick="showDifficultyMenu()">Play</button>
        </div>

        <!-- SECOND SCREEN: DIFFICULTY SELECT -->
        <div id="difficulty-menu" class="menu-screen">
            <h1>SELECT LEVEL</h1>
            <button class="btn btn-easy" onclick="initGame('easy')">Easy</button>
            <button class="btn btn-avg"  onclick="initGame('average')">Average</button>
            <button class="btn btn-hard" onclick="initGame('hard')">Hard</button>
        </div>

        <!-- GAME OVER SCREEN -->
        <div id="game-over-screen" class="menu-screen">
            <h1>GAME OVER</h1>
            <p style="color: white; font-size: 20px; margin: 0;">
                Score: <span id="final-score">0</span>
            </p>
            <button class="btn btn-restart" onclick="resetGame()">Try Again</button>
            <button class="btn btn-avg" onclick="location.reload()">Menu</button>
        </div>
    </div>

    <!-- SOUND EFFECTS -->
    <audio id="start-sound" src="star.mp3" preload="auto"></audio>
    <audio id="end-sound"   src="game_end_voice.mp3" preload="auto"></audio>
    <audio id="flap-sound"  src="" preload="auto"></audio>
    <audio id="bgm-sound"   src="start.mp3" preload="auto" loop></audio>

    <script>
        const gameContainer = document.getElementById('game-container');
        const bird = document.getElementById('bird');
        const wingLeft = document.getElementById('wing-left');
        const wingRight = document.getElementById('wing-right');

        const scoreDisplay = document.getElementById('score');
        const finalScoreDisplay = document.getElementById('final-score');

        const mainMenu = document.getElementById('main-menu');
        const difficultyMenu = document.getElementById('difficulty-menu');
        const gameOverScreen = document.getElementById('game-over-screen');

        const startSound = document.getElementById('start-sound');
        const endSound   = document.getElementById('end-sound');
        const flapSound  = document.getElementById('flap-sound');
        const bgmSound   = document.getElementById('bgm-sound');
        
        let GAME_WIDTH = gameContainer.clientWidth;
        let GAME_HEIGHT = gameContainer.clientHeight;

        let birdY = 200;
        let birdVelocity = 0;

        let gravity = 0.35;
        let jumpStrength = -7;

        let isGameOver = false;
        let score = 0;
        let gameLoopId;
        let pipeIntervalId;
        let isGameRunning = false;

        const PIPE_WIDTH = 60;

        let currentMode = 'easy';
        let pipeGap = 280;
        let pipeSpeed = 2;
        let pipeFreq = 1900;

        let goingUp = false; // track when bird is moving upward

        window.addEventListener('resize', () => {
            location.reload();
        });

        function showDifficultyMenu() {
            mainMenu.style.display = 'none';
            difficultyMenu.style.display = 'flex';
        }

        function initGame(mode) {
            currentMode = mode;

            if (mode === 'easy') {
                gravity = 0.28;
                jumpStrength = -7;
                pipeGap = 340;
                pipeSpeed = 1.7;
                pipeFreq = 2300;
            } else if (mode === 'average') {
                gravity = 0.34;
                jumpStrength = -6.5;
                pipeGap = 250;
                pipeSpeed = 2.3;
                pipeFreq = 1900;
            } else if (mode === 'hard') {
                gravity = 0.38;
                jumpStrength = -6;
                pipeGap = 200;
                pipeSpeed = 2.8;
                pipeFreq = 1750;
            }

            GAME_WIDTH = gameContainer.clientWidth;
            GAME_HEIGHT = gameContainer.clientHeight;

            difficultyMenu.style.display = 'none';
            gameOverScreen.style.display = 'none';

            goingUp = false;
            wingLeft.classList.remove('fast-flap');
            wingRight.classList.remove('fast-flap');

            if (startSound) {
                startSound.pause();
                startSound.currentTime = 0;
                startSound.play().catch(() => {});
            }

            if (bgmSound) {
                bgmSound.volume = 0.6;
                bgmSound.play().catch(() => {});
            }

            startGame();
        }

        function startGame() {
            isGameRunning = true;
            isGameOver = false;
            score = 0;
            scoreDisplay.innerText = 0;

            const birdHeight = bird.offsetHeight || 60;

            birdY = GAME_HEIGHT / 2 - birdHeight / 2;
            birdVelocity = 0;
            bird.style.top = birdY + 'px';
            bird.style.left = Math.round(GAME_WIDTH * 0.15) + 'px';
            bird.style.transform = 'rotate(0deg)';

            gameLoopId = setInterval(() => {
                if (isGameOver) return;

                birdVelocity = Math.min(birdVelocity + gravity, 9.5);
                birdY += birdVelocity;
                bird.style.top = birdY + 'px';

                // tilt based on velocity
                bird.style.transform = `rotate(${Math.min(birdVelocity * 3, 70)}deg)`;

                // Wing speed logic: faster when going up (negative velocity)
                if (birdVelocity < 0 && !goingUp) {
                    goingUp = true;
                    wingLeft.classList.add('fast-flap');
                    wingRight.classList.add('fast-flap');
                } else if (birdVelocity >= 0 && goingUp) {
                    goingUp = false;
                    wingLeft.classList.remove('fast-flap');
                    wingRight.classList.remove('fast-flap');
                }

                if (birdY <= -10 || birdY + birdHeight >= GAME_HEIGHT + 5) {
                    endGame();
                }

                checkCollisions();
            }, 20);

            pipeIntervalId = setInterval(createPipe, pipeFreq);
            
            document.addEventListener('keydown', control);
            document.addEventListener('click', control);
            document.addEventListener('touchstart', control, { passive: false });
        }

        function control(e) {
            if (!isGameRunning || isGameOver) return;

            if (e.type === 'touchstart') {
                e.preventDefault();
                birdVelocity = jumpStrength;
                return;
            }

            if (e.code === 'Space') {
                e.preventDefault();
                birdVelocity = jumpStrength;
            } else if (e.type === 'click') {
                birdVelocity = jumpStrength;
            }
        }

        function createPipe() {
            if (isGameOver) return;

            const pipeTop = document.createElement('div');
            const pipeBottom = document.createElement('div');
            
            pipeTop.classList.add('pipe', 'pipe-top');
            pipeBottom.classList.add('pipe', 'pipe-bottom');
            
            const minPipeHeight = 60;
            const maxPipeHeight = GAME_HEIGHT - pipeGap - minPipeHeight;
            const randomHeight = Math.floor(Math.random() * (maxPipeHeight - minPipeHeight)) + minPipeHeight;
            
            pipeTop.style.height = randomHeight + 'px';
            pipeTop.style.top = '0';
            pipeTop.style.left = GAME_WIDTH + 'px';
            
            pipeBottom.style.height = (GAME_HEIGHT - randomHeight - pipeGap) + 'px';
            pipeBottom.style.bottom = '0';
            pipeBottom.style.left = GAME_WIDTH + 'px';
            
            gameContainer.appendChild(pipeTop);
            gameContainer.appendChild(pipeBottom);
            
            let pipePosition = GAME_WIDTH;
            const pipeTimer = setInterval(() => {
                if (isGameOver) {
                    clearInterval(pipeTimer);
                    pipeTop.remove();
                    pipeBottom.remove();
                    return;
                }

                pipePosition -= pipeSpeed;
                pipeTop.style.left = pipePosition + 'px';
                pipeBottom.style.left = pipePosition + 'px';
                
                if (pipePosition < -PIPE_WIDTH) {
                    clearInterval(pipeTimer);
                    pipeTop.remove();
                    pipeBottom.remove();
                    score++;
                    scoreDisplay.innerText = score;
                }
            }, 20);
        }

        function checkCollisions() {
            const birdRect = bird.getBoundingClientRect();

            const hitBox = {
                left:   birdRect.left + 10,
                right:  birdRect.right - 10,
                top:    birdRect.top + 10,
                bottom: birdRect.bottom - 10
            };

            const pipes = document.querySelectorAll('.pipe');
            pipes.forEach(pipe => {
                const pipeRect = pipe.getBoundingClientRect();
                if (
                    hitBox.left < pipeRect.right &&
                    hitBox.right > pipeRect.left &&
                    hitBox.top < pipeRect.bottom &&
                    hitBox.bottom > pipeRect.top
                ) {
                    endGame();
                }
            });
        }

        function endGame() {
            if (isGameOver) return;
            isGameOver = true;
            isGameRunning = false;

            clearInterval(gameLoopId);
            clearInterval(pipeIntervalId);

            if (bgmSound) {
                bgmSound.pause();
            }

            if (endSound) {
                endSound.pause();
                endSound.currentTime = 0;
                endSound.play().catch(() => {});
            }

            wingLeft.classList.remove('fast-flap');
            wingRight.classList.remove('fast-flap');
            goingUp = false;

            finalScoreDisplay.innerText = score;
            gameOverScreen.style.display = 'flex'; 

            document.removeEventListener('keydown', control);
            document.removeEventListener('click', control);
            document.removeEventListener('touchstart', control);
        }

        function resetGame() {
            document.querySelectorAll('.pipe').forEach(p => p.remove());
            initGame(currentMode);
        }
    </script>
</body>
</html>
